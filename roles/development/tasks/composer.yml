---
- name: Check if composer is installed
  stat: path=/usr/local/bin/composer
  register: composer_bin_file

- name: Download installer
  get_url:
    url: https://getcomposer.org/installer
    dest: /home/vagrant/composer-setup.php
  when: composer_bin_file.stat.exists == False

- name: Install
  become: true
  shell: php /home/vagrant/composer-setup.php --filename=composer --install-dir=/usr/local/bin
  when: composer_bin_file.stat.exists == False

- name: Delete installer
  file: path=/home/vagrant/composer-setup.php state=absent
  when: composer_bin_file.stat.exists == False